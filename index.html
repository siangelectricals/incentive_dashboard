<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>Incentive Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      max-width: 600px;
    }
    input, button {
      padding: 8px;
      margin: 10px 0;
      width: 100%;
    }
    #result {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Salesman Incentive Dashboard</h2>

  <label for="password">请输入销售员密码：</label><br>
  <input type="password" id="password" placeholder="请输入密码"><br>
  <button onclick="loadDashboard()">查询奖金</button>

  <div id="result"></div>

  <script>
    // 密码映射到销售员名称
    const passwordMap = {
      'abc123': 'JIE NEE(BS006)',
      'xyz789': 'JING FAN(SJ094)',
      'mypass': 'VENUS PEH(PB2087)'
    };

    // Google Sheet ID 和工作表名称
    const sheetId = "16SxQScgSCQ3pPn3awFl0USWmV2xRn-ZDgwBbrvkSkQY";
    const sheetName = "Sheet1";

    // opensheet.elk.sh 生成的 JSON URL
    const url = `https://opensheet.elk.sh/${sheetId}/${sheetName}`;

    async function loadDashboard() {
      const password = document.getElementById('password').value;
      const salesman = passwordMap[password];

      const resultBox = document.getElementById('result');
      resultBox.innerText = '加载中...';

      if (!salesman) {
        resultBox.innerText = '密码无效，请重试。';
        return;
      }

      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error("网络响应错误");

        const data = await response.json();

        // 根据Salesman过滤，累计Incentive
        const total = data
          .filter(row => row.Salesman === salesman)
          .reduce((sum, row) => sum + parseFloat(row.Incentive || 0), 0);

        resultBox.innerText = `${salesman} 的总激励奖金为：${total.toFixed(2)}`;
      } catch (err) {
        resultBox.innerText = '读取数据失败，请检查链接或网络。';
        console.error(err);
      }
    }
  </script>
</body>
</html>
